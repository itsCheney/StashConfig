name: 'ğŸ§° å°çº¢ä¹¦å»å¹¿å‘Š'
desc: |-
  è¿‡æ»¤ä¿¡æ¯æµæ¨å¹¿ï¼Œç§»é™¤ç¬”è®°å’Œè¯„è®ºåŒºå›¾ç‰‡è§†é¢‘ä»¥åŠ live å›¾æ°´å°ã€‚
  ç§»é™¤è¯„è®ºåŒºè¡¨æƒ…åŒ…æ°´å°å’Œä¸‹è½½é™åˆ¶ã€‚å¦‚æœ‰å¼‚å¸¸ï¼Œè¯·å…ˆæ¸…é™¤ç¼“å­˜å†å°è¯•ã€‚
openUrl: ''
author: |-
  Mashiro3
homepage: 'https://github.com/mist-whisper/Script'
icon: ''
category: 'Mashiro3'
date: '2025-07-31 16:37:00'
version: '1.0.0'

# â€”â€” åˆ†æµï¼ˆåŸŸåçº§æ‹¦æˆªï¼‰ï¼Œå¯¹åº”ï¼šHOST, xxx, REJECT â€”â€”
rules:
  - DOMAIN,ads-img-qc.xhscdn.com,REJECT
  - DOMAIN,ads-video-al.xhscdn.com,REJECT
  - DOMAIN,ads-video-qc.xhscdn.com,REJECT
  - DOMAIN,t-ads.xiaohongshu.com,REJECT

http:
  # å»ºè®®å¼ºåˆ¶èµ° HTTP å¼•æ“ï¼Œç¡®ä¿é‡å†™/è„šæœ¬å‘½ä¸­
  force-http-engine:
    - 'edith.xiaohongshu.com:443'
    - 'www.xiaohongshu.com:443'
    - 'ci.xiaohongshu.com:443'
    - 'rec.xiaohongshu.com:443'

  # å¼€å¯ MitM çš„åŸŸåï¼ˆè„šæœ¬/é‡å†™éœ€è¦ï¼‰
  mitm:
    - 'edith.xiaohongshu.com'
    - 'www.xiaohongshu.com'
    - 'ci.xiaohongshu.com'
    - 'rec.xiaohongshu.com'

  # â€”â€” URL é‡å†™ï¼ˆæ‹’ç»/ç©ºå“åº”ç­‰ï¼‰ï¼Œå¯¹åº”ï¼šurl reject-* / reject-img / reject-dict â€”â€”
  url-rewrite:
    # æƒŠå–œå¼¹çª—
    - ^https?:\/\/edith\.xiaohongshu\.com\/api\/sns\/v\d\/surprisebox\/(get_style|open|submit_action) - reject-dict
    - ^https?:\/\/www\.xiaohongshu\.com\/api\/marketing\/box\/trigger\? - reject-dict

    # ä¿¡æ¯æµå¹¿å‘Šä¸å¼•å¯¼
    - ^https?:\/\/edith\.xiaohongshu\.com\/api\/sns\/v\d\/note\/guide\? - reject-dict
    - ^https?:\/\/edith\.xiaohongshu\.com\/api\/sns\/v\d\/guide\/user_banner - reject-dict
    - ^https?:\/\/www\.xiaohongshu\.com\/api\/sns\/(v\d\/ads\/resource|v\d\/hey\/\w+\/hey_gallery) - reject-dict

    # è¯„è®ºåŒºå›¾ç‰‡æ°´å°é…ç½®ï¼ˆç›´æ¥è¿”å› 1px å›¾ï¼‰
    - ^https?:\/\/ci\.xiaohongshu\.com\/system_config\/watermark - reject-img

  # â€”â€” è„šæœ¬æ”¹å†™ï¼Œå¯¹åº”ï¼šscript-response-body â€”â€” 
  script:
   # idç½®ç©º
    - match: ^https?:\/\/edith\.xiaohongshu\.com\/api\/sns\/v\d\/note\/comment\/list
      name: 'REDnote-comment-replace'
      type: response
      require-body: true
      timeout: 10
      argument: pattern=red_id&replace=fmz200
    # æœç´¢é¡µ
    - match: ^https?:\/\/edith\.xiaohongshu\.com\/api\/sns\/v\d\/search\/(banner_list|hot_list)
      name: 'REDnote.remove_ads'
      type: response
      require-body: true
    - match: ^https?:\/\/edith\.xiaohongshu\.com\/api\/sns\/v\d\/search\/(hint|trending)\?
      name: 'REDnote.remove_ads'
      type: response
      require-body: true
    - match: ^https?:\/\/edith\.xiaohongshu\.com\/api\/sns\/v\d\/search\/notes\?
      name: 'REDnote.remove_ads'
      type: response
      require-body: true

    # å¼€å±å¹¿å‘Š
    - match: ^https?:\/\/edith\.xiaohongshu\.com\/api\/sns\/v\d\/system_service\/config\?
      name: 'REDnote.remove_ads'
      type: response
      require-body: true
    - match: ^https?:\/\/edith\.xiaohongshu\.com\/api\/sns\/v\d\/system_service\/splash_config
      name: 'REDnote.remove_ads'
      type: response
      require-body: true

    # è¯¦æƒ…é¡µå°éƒ¨ä»¶
    - match: ^https?:\/\/edith\.xiaohongshu\.com\/api\/sns\/v\d\/note\/widgets
      name: 'REDnote.remove_ads'
      type: response
      require-body: true

    # å›¾ç‰‡/è§†é¢‘æ°´å°ä¸æ—¶é—´çº¿ä¿¡æ¯æµ
    - match: ^https?:\/\/(edith|rec|www)\.xiaohongshu\.com\/api\/sns\/v\d\/note\/(imagefeed|live_photo\/save)
      name: 'REDnote.remove_ads'
      type: response
      require-body: true
    - match: ^https?:\/\/(edith|rec|www)\.xiaohongshu\.com\/api\/sns\/v\d\/(followfeed|homefeed)\?
      name: 'REDnote.remove_ads'
      type: response
      require-body: true
    - match: ^https?:\/\/(edith|rec|www)\.xiaohongshu\.com\/api\/sns\/(v2\/note\/feed|v3\/note\/videofeed)\?
      name: 'REDnote.remove_ads'
      type: response
      require-body: true
    - match: ^https?:\/\/(edith|rec|www)\.xiaohongshu\.com\/api\/sns\/(v4\/note\/videofeed|v10\/note\/video\/save)\?
      name: 'REDnote.remove_ads'
      type: response
      require-body: true

    # è¯„è®ºåŒºå›¾ç‰‡ã€live å›¾æ°´å° & è¡¨æƒ…åŒ…ä¸‹è½½
    - match: ^https:\/\/edith\.xiaohongshu\.com\/api\/sns\/(v5\/note\/comment\/list|v3\/note\/comment\/sub_comments)\?
      name: 'REDnote.remove_ads'
      type: response
      require-body: true
    - match: ^https:\/\/edith\.xiaohongshu\.com\/api\/sns\/v1\/interaction\/comment\/video\/download\?
      name: 'REDnote.remove_ads'
      type: response
      require-body: true

script-providers:
  'REDnote.remove_ads':
    url: https://raw.githubusercontent.com/mist-whisper/Script/master/REDnote/REDnote_remove_ads.js
    interval: 86400
  'REDnote-comment-replace':
    url: https://cdn.jsdelivr.net/gh/itsCheney/StashConfig/JavaScript/REDnote-comment-replace.js
    interval: 86400
